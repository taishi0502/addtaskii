  <div class="mypage" >

   <div class="row">
   <div class="contents row">
  <h1 class="mypage-title"><%= @name %><span class="sannno">さんの</span>Mision List</h1>
<% unless user_signed_in? %>
<% else %>
  <div class="mb-3">
    <%= link_to 'missionを設定', new_mission_path, class: "btn btn-primary" %>
    <%= link_to 'みんなのMission',missions_path, class: "btn btn-success" %>
    
  </div>
  
<% end %>

  <% @missions.each do |mission| %>
  <div class="col-md-12 pt-3  ">
    <div class="card shadow">
    <div class="mission_user_name">
         <div class="myname">My Mission</div>
    </div>
      <div class="card-body " >
        <h5 class="card-title"> <%= mission.mission%></h5>
         <ul class="list-group list-group-flush">
         <li class="list-group-item">開始日　<%= mission.startdate%></li>
         <li class="list-group-item">期限　　<%= mission.limitdate%></li>
         </ul>
<% if mission.tasks.present? %>
<% else %>
<div class="row">
       <div class="spinner-grow text-danger col-6" role="status">
         <span class="visually-hidden">いいいいいいい</span>
       </div>
       <div class="alert alert-danger col-6" role="alert">
         この課題に対する具体的なアクションを設定しないため達成できない可能性があります！
      </div>
</div>  
<% end %>
      <div class="tasks">
       <% if mission.tasks.present? %>
       <p>＜タスク一覧＞</p>
       <% else %>
      
       <% end %>
      
      <% mission.tasks.each do |t| %>
         <p>
           <%= t.task %>
        </p>
      <% end %>
     </div>   
 
  

        <p class="card-text text-right"></p>
  <% if user_signed_in? && current_user.id == mission.user.id %>
        <% if mission.tasks.present? %>
          <%= link_to 'タスクを追加', mission_path(mission.id),method: :get, class: "btn btn-primary"%>
        <% else %>
          <%= link_to 'タスク設定', mission_path(mission.id),method: :get, class: "btn btn-danger"%>
        <% end %>
  <% else %>
          <%= link_to '詳細', mission_path(mission.id),method: :get, class: "btn btn-success"%>
  <% end %>

    <% if user_signed_in? && current_user.id == mission.user.id %>

        <%= link_to '編集', edit_mission_path(mission.id),method: :get, class: "btn btn-primary"%>
        <%= link_to '削除', mission_path(mission.id),method: :delete, class: "btn btn-primary"%>
    <% end %>

  <%# <% @missions.each do |mission| %>
    <%# (<%= mission.favorited_users.count %>
   <%# <% end %>  
<% if user_signed_in? && current_user.id %>
<% if mission.favorited_by?(current_user) %>
<%= link_to  mission_favorites_path(mission), method: :delete do %>
  <i class="bi bi-megaphone success"></i>
  
  <%= @mission.favorites.count  %>
<% end %>
<% else %>
<%= link_to mission_favorites_path(mission), method: :post do %>
  <i class="bi bi-megaphone success"></i>
  <%= mission.favorites.count %>
<% end %>
<% end %>
<% end %>

       </div>
    </div>
  </div>


  <% end %>

        <%# <%= render partial: "mypage", collection: @missions %> 

  </div>
</div>
</div>